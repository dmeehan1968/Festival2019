import serialize from 'serialize-javascript'

export default function createExpressCookieEngine(key, cookies = [], setCookie = (key, value, options) => {}, options = {}) {
  return {
    load: () => {
      return Promise.resolve(cookies[key] ? eval('(' + cookies[key] + ')') : {})
    },
    save: (state) => {
      setCookie(key, serialize(state, { isJSON: true }), options)
      return Promise.resolve()
    },
  }
}
