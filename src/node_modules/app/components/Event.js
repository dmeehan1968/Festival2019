import React from 'react'
import { connect } from 'react-redux'
import { Helmet } from 'react-helmet'

import VenueMap from 'app/components/VenueMap'
import OpeningTimes from 'app/components/OpeningTimes'
import Meta from 'app/components/Meta'

import styles from './Event.less'

const Event = ({ event = {}, dates = [] }) => {
  const unspecified = { description: 'Unspecified' }
  return (
    <section className={styles.event}>
      <Helmet>
        <title>{event.title}</title>
      </Helmet>
      <section className={styles.eventDetail}>
        <h1 className={styles.title}>{event.title}</h1>
        <dl>
          <Meta title="Status" content={event.eventstatus.map(s => s.description).join(', ')} />
          <Meta title="Subtitle" content={event.subtitle} />
          <Meta title="About the Event" content={event.shortdesc} />
          <Meta title="Event Type" content={event.eventtypes.map(e => e.description).join(', ')} />
          <Meta title="Disciplines" content={event.disciplines.map(d => d.description).join(', ')} />
          <Meta title="Telephone" content={event.contact.telephone} />
          <Meta title="Email" content={event.contact.email} />
          <Meta title="Web" content={event.contact.website} />
          <Meta title="Booking Contact" content="-" />
          <Meta title="Booking Info" content="-" />
          <Meta title="Age Info" content={event.ageinfo} />
          <Meta title="Opening Times" content={<OpeningTimes dates={dates} times={event.opening_times}/>} />
          <Meta title="Further Info" content={event.furtherinfo} />
          <Meta title="Long Description" content={event.longdesc} />
        </dl>
      </section>
      <section className={styles.venueDetail}>
        <h2>Venue Information</h2>
        <dl>
          <Meta
            title="Map"
            content={
              <VenueMap
                lat={event.venue.addresscontact.latitude}
                lng={event.venue.addresscontact.longitude}
                title={event.title}
              />
            }
          />
          <Meta title="Address" content={[
            event.venue.addresscontact.address1,
            event.venue.addresscontact.address2,
            event.venue.addresscontact.address3,
            event.venue.addresscontact.town,
            event.venue.addresscontact.county,
            event.venue.addresscontact.postcode,
            ].filter(addr => !!addr).map((addr, i) => <React.Fragment key={i}>{addr}<br /></React.Fragment>)} />
          <Meta title="For Venue Information" content={event.venue.telephone} />
          <Meta title="Region" content={event.venue.regions.map(r => r.description).join(', ')} />
          <Meta title="Disabled" content={(event.venue.disabled || unspecified).description} />
          <Meta title="Toilets" content={(event.venue.toilet || unspecified).description} />
          <Meta title="Dogs" content={(event.venue.dog || unspecified).description } />
          <Meta title="Refreshments" content={event.venue.refreshments} />
          <Meta title="Directions (By Foot)" content={event.venue.byfoot} />
          <Meta title="Directions (By Car)" content={event.venue.bycar} />
          <Meta title="Directions (By Public Transport)" content={event.venue.bypublictransport} />
          <Meta title="Parking" content={event.venue.parking} />
          <Meta title="Further Info" content={event.venue.furtherinfo} />
        </dl>
      </section>
    </section>
  )
}

const mapStateToProps = state => ({
  event: state.event,
  dates: state.dates,
})

const mapDispatchToProps = dispatch => ({
  // setEvents: events => dispatch(setEvents(events))
})

export default connect(mapStateToProps, mapDispatchToProps)(Event)
